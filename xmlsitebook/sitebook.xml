<?xml version="1.0"?>


<sitebook xmlns:fo="http://www.w3.org/1999/XSL/Format">
	<cover>
		<title>Operations Manual</title>
	</cover>
	<revisions>
		<revision>
			<version>1.0</version>
			<date>9/22/05</date>
			<author>Jordan Sissel</author>
			<sections>All</sections>
			<deltas>Created sitebook</deltas>
		-</revision>
		<revision>
			<version>1.1</version>
			<date>9/23/05</date>
			<author>Jordan Sissel</author>
			<sections>Test Plans</sections>
			<deltas>Added several regression test plans</deltas>
		</revision>
		<revision>
			<version>1.2</version>
			<date>10/8/05</date>
			<author>Jordan Sissel</author>
			<sections>All</sections>
			<deltas>Moved to new XML format</deltas>
		</revision>
	</revisions>

	<section title="References">
		<p>
		What goes here? :(
		</p>
	</section>

	<section title="Systems">
		<section title="Server Layout">
			<img src="layout.png" />
		</section>
		<section title="Server Information">
			<section title="earth.captainplanet.sys">
				<p>
				<b>Operating System:</b> FreeBSD 5.4
				</p>

				<p>
				<b>Services and Roles</b>
				<ul>
					<li> Primary DNS </li>
					<li> DHCP </li>
					<li> NIS Slave </li>
					<li> NIS Client </li>
				</ul>
				</p>
			</section>
			<section title="wind.captainplanet.sys">
			<p>
				<b>Operating System:</b> FreeBSD 5.4
			</p>

			<p>
			<b>Services and Roles</b>
			<ul>
				<li> NIS Client </li>
				<li> Mail Server (Gateway) </li>
			</ul>
			</p>
			</section>
			<section title="water.captainplanet.sys">
			<p>
				<b>Operating System:</b> Windows 2000 Server
			</p>

			<p>
				<b>Services and Roles</b>
				<ul>
					<li> AD Domain Controller: All FSMO Roles </li>
					<li> Exchange Front-end Server </li>
					<li> NIS Master </li>
				</ul>
			</p>
			</section>
			<section title="fire.captainplanet.sys">
			<p>
				<b>Operating System:</b> Windows 2000 Server
			</p>

			<p>
				<b>Services and Roles</b>
				<ul>
					<li> AD Domain Controller: Global Catalog </li>
					<li> Exchange Back-end Server </li>
				</ul>
			</p>
			</section>
		</section>
		<section title="System Partition Layouts">
			<section title="earth.captainplanet.sys">
				<table>
					<th>
						<td width="1in">Disk Name</td>
						<td width="1.3in">Mount Point</td>
						<td width=".6in">Size</td>
						<td width="3in">Description</td>
					</th>
					<tr>
						<td>ad0s1a</td>
						<td>/</td>
						<td>128M</td>
						<td>Root partition (kernel, /etc)</td>
					</tr>
					<tr>
						<td>ad0s1b</td>
						<td>swap</td>
						<td>256M</td>
						<td>Swap partition</td>
					</tr>
					<tr>
						<td>ad0s1d</td>
						<td>/tmp</td>
						<td>256M</td>
						<td>Temporary file/socket staging</td>
					</tr>
					<tr>
						<td>ad0s1e</td>
						<td>/var</td>
						<td>128M</td>
						<td>System databases and logs</td>
					</tr>
					<tr>
						<td>ad0s1f</td>
						<td>/usr</td>
						<td>403M</td>
						<td>Userland and home directories</td>
					</tr>
				</table>
			</section>
			<section title="wind.captainplanet.sys">
				<table>
					<th>
						<td width="1in">Disk Name</td>
						<td width="1.3in">Mount Point</td>
						<td width=".6in">Size</td>
						<td width="3in">Description</td>
					</th>
					<tr>
						<td>ad0s1a</td>
						<td>/</td>
						<td>128M</td>
						<td>Root partition (kernel, /etc)</td>
					</tr>
					<tr>
						<td>ad0s1b</td>
						<td>swap</td>
						<td>256M</td>
						<td>Swap partition</td>
					</tr>
					<tr>
						<td>ad0s1d</td>
						<td>/tmp</td>
						<td>256M</td>
						<td>Temporary file/socket staging</td>
					</tr>
					<tr>
						<td>ad0s1e</td>
						<td>/var</td>
						<td>128M</td>
						<td>System databases and logs</td>
					</tr>
					<tr>
						<td>ad0s1f</td>
						<td>/usr</td>
						<td>403M</td>
						<td>Userland and home directories</td>
					</tr>
				</table>
			</section>
			<section title="water.captainplanet.sys">
				<table>
					<th>
						<td width="1in">Disk Name</td>
						<td width="1.3in">Mount Point</td>
						<td width=".6in">Size</td>
						<td width="3in">Description</td>
					</th>
					<tr>
						<td>Primary HDD (Channel 0 Master)</td>
						<td>C:</td>
						<td>40G</td>
						<td>Complete System (programs and data)</td>
					</tr>
				</table>
			</section>
			<section title="fire.captainplanet.sys">
				<table>
					<th>
						<td width="1in">Disk Name</td>
						<td width="1.3in">Mount Point</td>
						<td width=".6in">Size</td>
						<td width="3in">Description</td>
					</th>
					<tr>
						<td>Primary HDD (Channel 0 Master)</td>
						<td>C:</td>
						<td>40G</td>
						<td>Complete System (programs and data)</td>
					</tr>
				</table>
			</section>
		</section>
	</section>
	<section title="Known Issues">
		<section title="NIS">
			<p>
				NIS Passwords are transmitted to slaves and clients (and thusly
				viewable by users) in their hashed forms. Any normal user can
				'ypcat passwd' and run john on the passwd file to guess passwords.
				Also, using NIS requires RPC. RPC uses lots of random ports, making
				securing anything using NIS difficult. A script can possibly be
				written to dynamically pull ports used by rpc services and add them
				to the firewall.
			</p>
		</section>
		<section title="DNS">
			<p>
				Active Directory requires that a host-based trust be established
				between any domain controllers and the primary DNS server. This is
				a horrible "feature" but isn't likely fixable.  Any user process on
				any domain controller will be able to send DNS updates to the
				primary dns server.
			</p>
		</section>
		<section title="Mail">
			<p>
				The Unix mail server, Sendmail, is not yet configured for
				authenticated SMTP. The server is only configured to allow relays
				from the local net, but that still means any computer on the local
				network is able to relay. Authenticated SMTP would provide a
				clearer audit trail for tracing abuse.
			</p>
		</section>
		<section title="Outlook Web Access">
			<p>
				OWA (http://exchange.captainplanet.sys/exchange/) will sometimes
				break after a successful login via http auth. This causes
				'inetinfo.exe' on the frontend server to break. The cause is unknown
				as there are no logs indicating why. The only fix is a reboot as
				inetinfo.exe quickly consumes all cpu and virtual memory on the
				system.
			</p>
			<p><b>Solution:</b> Don't use use OWA?</p>
			<p><b>How to repeat:</b> Login using OWA. </p>
		</section>
	</section>
	<section title="Server and Service Configuration">
		<section title="earth.captainplanet.sys"> 
			<section title="DNS Master" />
			<section title="DHCP Server" />
			<section title="NIS Slave?" />
			<section title="System settings: rc.conf" />
			<section title="Firewall: pf.conf" />
			<section title="Mail submission: mail/earth.submit.mc" />
		</section>
		<section title="wind.captainplanet.sys"> 
			<section title="Sendmail">
				<section title="mail/wind.mc" />
				<section title="mail/wind.submit.mc" />
				<section title="mail/mailertable" />
			</section>
			<section title="System settings:rc.conf" />
			<section title="Firewall: pf.conf" />
		</section>
		<section title="water.captainplanet.sys">
		</section>
		<section title="fire.captainplanet.sys"> </section>
	</section>
</sitebook>
